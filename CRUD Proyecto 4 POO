import requests
base_url = 'http://127.0.0.1:8000/api/programmers/'

def create_programmer():
    fullname = input("Ingrese el nombre completo: ")
    nickname = input("Ingrese el apodo: ")
    language = input("Ingrese el lenguaje: ")
    age = int(input("Ingrese la edad: "))
    is_active_input = input("Está activo? (Si/No): ")
    is_active = is_active_input.lower() == 'si'
    data = {
        'fullname': fullname,
        'nickname': nickname,
        'language': language,
        'age': age,
        'is_active': is_active
    }
    response = requests.post(base_url, data=data)
    if response.status_code == 201:
        print("\nProgramador creado exitosamente:", response.json())
    else:
        print("\nError al crear el programador:", response.status_code)

def get_all_programmers():
    response = requests.get(base_url)
    if response.status_code == 200:
        print("\nLista de programadores:")
        for programmer in response.json():
            print(programmer)
    else:
        print("\nError al obtener los programadores:", response.status_code)

def update_programmer():
    programmer_id = int(input("Ingrese el ID del programador a actualizar: "))
    fullname = input("Ingrese el nuevo nombre completo: ")
    nickname = input("Ingrese el nuevo apodo: ")
    language = input("Ingrese el nuevo lenguaje: ")
    age = int(input("Ingrese la nueva edad: "))
    is_active_input = input("Está activo? (Si/No): ")
    is_active = is_active_input.lower() == 'si'
    data = {
        'fullname': fullname,
        'nickname': nickname,
        'language': language,
        'age': age,
        'is_active': is_active
    }
    url = f'{base_url}{programmer_id}/'
    response = requests.put(url, data=data)
    if response.status_code == 200:
        print("\nProgramador actualizado exitosamente:", response.json())
    else:
        print("\nError al actualizar el programador:", response.status_code)

def delete_programmer():
    programmer_id = int(input("Ingrese el ID del programador a eliminar: "))
    url = f'{base_url}{programmer_id}/'
    response = requests.delete(url)
    if response.status_code == 204:
        print("\nProgramador eliminado exitosamente.")
    else:
        print("\nError al eliminar el programador:", response.status_code)

def menu():
    while True:
        print("\n=== Menú CRUD Programadores ===")
        print("1. Crear programador")
        print("2. Ver todos los programadores")
        print("3. Actualizar programador")
        print("4. Eliminar programador")
        print("5. Salir")

        opcion = input("Seleccione una opción: ")

        if opcion == '1':
            create_programmer()
        elif opcion == '2':
            get_all_programmers()
        elif opcion == '3':
            update_programmer()
        elif opcion == '4':
            delete_programmer()
        elif opcion == '5':
            print("\nSaliendo del programa. ¡Hasta luego!")
            break
        else:
            print("\nOpción no válida. Intente de nuevo.")

if __name__ == '__main__':
    menu()
